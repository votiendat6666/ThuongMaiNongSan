{% for p in products %}

<div class="col" style="padding:rem;">

    <div class="card h-100 d-flex flex-column justify-content-between"
         style="border-radius: 0.4rem;
            transition: all 0.3s ease;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);"
         onmouseover="this.style.transform='scale(1.03)'; this.style.boxShadow='0 12px 24px rgba(0,0,0,0.2)'"
         onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 2px 6px rgba(0,0,0,0.1)'">


        <a href="/products/{{ p.id }}" style="text-decoration: none; color:#333333; ">
            <div style="position: relative; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                <img class="card-img-top" style="width: 187px;height:187px; border-radius: 0.5rem;" src="{{ p.image }}"
                     alt="Card image">
                <img src="https://img.ws.mms.shopee.vn/vn-11134210-7qukw-lh7bshlcfd9v86" alt=""
                     style="position: absolute; bottom: -1px; left: 15px; width: 100px; border-radius: 0.3rem; z-index: 0;">
            </div>

            <div class="card-body d-flex flex-column" style="flex-grow: 1; padding: 0.75rem;">
                <!-- Tên sách -->
                <div style="line-height: 1.3em; overflow: hidden; display: -webkit-box;
                -webkit-line-clamp: 2; -webkit-box-orient: vertical;
                font-size:14px; color:black; font-weight: 500;">
                    {{ p.name }}
                </div>

                <!-- Rẻ Vô Địch + Giảm giá -->
                <div style="display: flex; gap: 8px; align-items: center; margin-top: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                    <!-- Rẻ Vô Địch -->
                    <span style="
                        font-size: 10px;
                        color: #EE4D2D;
                        border: 1px solid #EE4D2D;
                        border-radius: 2px;
                        text-align: center;
                        width: 70px;
                        height: 18px;
                        line-height: 18px;
                        display: inline-block; ">
                        Rẻ Vô Địch
                    </span>

                    <!-- Vé giảm giá (ảnh + chữ nằm giữa) -->
                    <div style="position: relative; width: 80px; height: 18px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                        <img src="{{ url_for('static', filename='images/voucher.png') }}"
                             alt="voucher"
                             style="width: 80%; height: 100%; display: block;">
                        <span style="
                                    position: absolute;
                                    top: 50%;
                                    left: 40%;
                                    transform: translate(-50%, -50%);
                                    font-size: 10px;
                                    color: white;
                                    white-space: nowrap;
                                ">Giảm {{ p.voucher|int }}%</span>
                    </div>
                </div>


                <!-- Giá thực tế: đẩy xuống đáy -->
                <div style="display: flex; gap: 8px; align-items: center; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                    <div style="margin-top: 0.5rem; ">
                        <span class="card-text" style="color:#EE4D2D; font-size:16px; font-weight:500px;">
                            {{ p.price|format_vnd }}đ
                        </span>
                    </div>

                    <div style="margin-top: 0.5rem; text-align: right; flex-grow: 1;">
                        <span class="card-text" style="color:#555; font-size:12px; text-align:right;">
                            Đã bán {{ p.daban|int }}
                        </span>
                    </div>

                </div>

            </div>

        </a>
    </div>

</div>

{% endfor %}
